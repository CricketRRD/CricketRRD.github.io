<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>cricket-users: Re: [cricket-users] Possible feature?</TITLE>
<META NAME="Author" CONTENT="Alan Nichols (Alan.Nichols@EBay.Sun.COM)">
<META NAME="Subject" CONTENT="Re: [cricket-users] Possible feature?">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1>Re: [cricket-users] Possible feature?</H1>
<!-- received="Mon Jul 12 22:08:14 1999" -->
<!-- isoreceived="19990713050814" -->
<!-- sent="Mon, 12 Jul 1999 19:06:50 -0700 (PDT)" -->
<!-- isosent="19990713020650" -->
<!-- name="Alan Nichols" -->
<!-- email="Alan.Nichols@EBay.Sun.COM" -->
<!-- subject="Re: [cricket-users] Possible feature?" -->
<!-- id="199907130206.TAA06059@lapaz.EBay.Sun.COM" -->
<!-- inreplyto="[cricket-users] Possible feature?" -->
<STRONG>From:</STRONG> Alan Nichols (<A HREF="mailto:Alan.Nichols@EBay.Sun.COM?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;"><EM>Alan.Nichols@EBay.Sun.COM</EM></A>)<BR>
<STRONG>Date:</STRONG> Mon Jul 12 1999 - 19:06:50 PDT
<P>
<!-- next="start" -->
<UL>
<LI><STRONG>Next message:</STRONG> <A HREF="0311.html">Campbell Simpson: "[cricket-users] Differences in graphing between 0.65 and 0.68"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0309.html">Jeff Allen: "Re: [cricket-users] Possible feature?"</A>
<LI><STRONG>Maybe in reply to:</STRONG> <A HREF="0305.html">Berg, Ivan: "[cricket-users] Possible feature?"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0312.html">Berg, Ivan: "RE: [cricket-users] Possible feature?"</A>
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#310">[ date ]</A>
<A HREF="index.html#310">[ thread ]</A>
<A HREF="subject.html#310">[ subject ]</A>
<A HREF="author.html#310">[ author ]</A>
</UL>
<HR NOSHADE><P>
<!-- body="start" -->
<P>
From: Alan Nichols &lt;<A HREF="mailto:Alan.Nichols@EBay.Sun.COM?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">Alan.Nichols@EBay.Sun.COM</A>&gt;
<BR>
<P>Ivan:
<BR>
<P><EM>&gt;From the problem you describe, I take it you are using Cisco switches
</EM><BR>
and from time to time go into the switch and do a 'clear counters'
<BR>
command on the switch.  Doing this resets the counters you see in the
<BR>
CLI and visible through SNMP to 0.  This will cause RRD to see a 'spike'
<BR>
in traffic because it can not tell the difference between the counter
<BR>
being reset and the counter rolling over normally.
<BR>
<P>There are two ways to deal with this: set a max value, or don't clear
<BR>
counters on your switch.  A third way would be to complain loudly and
<BR>
long to Cisco for creating products that are not compliant with the
<BR>
SNMP standard.
<BR>
<P>Yes, you read that right - On this point, Cisco switches do *not* comply
<BR>
with the SNMP standards.  (Verifying this will take a bit of searching,
<BR>
but the key is in the definition of the 'Counter' datatype in the SMI
<BR>
RFC's, and in the definitions of 'ifInOctets' and 'ifOutOctets' in RFC1573).
<BR>
<P>Specifically, by the SNMP standard, a counter should *never* get reset
<BR>
to 0, unless you have some way of detecting that reset.  Cisco switches
<BR>
will reset their counters to zero and won't tell you that anything happened.
<BR>
<P>(Note: I submitted a complaint to Cisco about this and got a kinda snide
<BR>
'we like the way it works and will not change it' answer.  And they
<BR>
rewrote the IF-MIB so that they can get away with it in the future by
<BR>
implementing a 'ifCounterDiscontinuityTime' variable).
<BR>
<P>My recommendation: do not clear the counters on your switch.
<BR>
<P>Alan
<BR>
<P><EM>&gt;From: &quot;Berg, Ivan&quot; &lt;<A HREF="mailto:iberg@montana.edu?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">iberg@montana.edu</A>&gt;
</EM><BR>
<EM>&gt;To: &quot;'<A HREF="mailto:cricket-users@onelist.com?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">cricket-users@onelist.com</A>'&quot; &lt;<A HREF="mailto:cricket-users@onelist.com?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">cricket-users@onelist.com</A>&gt;
</EM><BR>
<EM>&gt;Mailing-List: list <A HREF="mailto:cricket-users@onelist.com?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">cricket-users@onelist.com</A>; contact 
</EM><BR>
<A HREF="mailto:cricket-users-owner@onelist.com?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">cricket-users-owner@onelist.com</A>
<BR>
<EM>&gt;Delivered-To: mailing list <A HREF="mailto:cricket-users@onelist.com?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">cricket-users@onelist.com</A>
</EM><BR>
<EM>&gt;List-Unsubscribe: &lt;mailto:<A HREF="mailto:cricket-users-unsubscribe@ONElist.com?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">cricket-users-unsubscribe@ONElist.com</A>&gt;
</EM><BR>
<EM>&gt;Mime-Version: 1.0
</EM><BR>
<EM>&gt;Subject: [cricket-users] Possible feature?
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;From: &quot;Berg, Ivan&quot; &lt;<A HREF="mailto:iberg@montana.edu?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">iberg@montana.edu</A>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;First of all, thanks Jeff for the quick response time on 0.68.  It is very
</EM><BR>
<EM>&gt;handy being
</EM><BR>
<EM>&gt;able to talk to developers first hand.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;Hey, do you think this could be added in a future version of cricket?
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;The problem is when a counter get's reset to zero.  This produces a large
</EM><BR>
<EM>&gt;spike in the
</EM><BR>
<EM>&gt;graph which throws off the range and average's for some time.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;It seems that was is stored in the data file is differences in data and this
</EM><BR>
<EM>&gt;is divided
</EM><BR>
<EM>&gt;by time to give us something like data/sec.  So it works my doing
</EM><BR>
<EM>&gt;(current data - last data)/ time.  Now this value is positive when the
</EM><BR>
<EM>&gt;counter is
</EM><BR>
<EM>&gt;incrementing and only negative when the counter gets reset to zero.  Would
</EM><BR>
<EM>&gt;it be possible
</EM><BR>
<EM>&gt;to add small routine to check if there is a negative difference and account
</EM><BR>
<EM>&gt;for it.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;Here a couple ideas to handle the negative and incorrect values.
</EM><BR>
<EM>&gt;1.  Throw away the data point, i.e  don't store it in the data.
</EM><BR>
<EM>&gt;2.  Set point to 0 to avoid spikes, it would still slightly affect average
</EM><BR>
<EM>&gt;but not as
</EM><BR>
<EM>&gt;    much as large spike.
</EM><BR>
<EM>&gt;3.  If detect negative value, then average the last two data points and
</EM><BR>
<EM>&gt;store that
</EM><BR>
<EM>&gt;    as the current data point.  That would be the most accurate of the three
</EM><BR>
<EM>&gt;and
</EM><BR>
<EM>&gt;    would not throw off the scale at all.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;Thanks
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;--------------------------- ONElist Sponsor ----------------------------
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;ONElist members are using Shared Files in great ways!
</EM><BR>
<EM>&gt;<A HREF="http://www.onelist.com">http://www.onelist.com</A>
</EM><BR>
<EM>&gt;Are you?  If not, see our homepage for details.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;------------------------------------------------------------------------
</EM><BR>
<P>-------------------------------------------------------------------------
<BR>
Email: <A HREF="mailto:Alan.Nichols@Sun.COM?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">Alan.Nichols@Sun.COM</A>	Phone:(408)276-1306
<BR>
Pager: <A HREF="mailto:Alan.Nichols@pager.ebay.sun.com?Subject=Re:%20[cricket-users]%20Possible%20feature?&In-Reply-To=&lt;199907130206.TAA06059@lapaz.EBay.Sun.COM&gt;">Alan.Nichols@pager.ebay.sun.com</A>	or (650)940-0687
<BR>
-----BEGIN GEEK CODE BLOCK-----
<BR>
Version: 3.1
<BR>
GCS/PA d- s:+ a- C++(++++)$ USC++++$ P++(+++)$ L&gt;++++ E+(+++)$
<BR>
W+(+++)$ N+$ o--- !K w--- O? M- V+ PS@ PE@ Y+&gt;+++$ PGP?&gt;+++ t+ !5 X+
<BR>
R* tv b+++&gt;++++ DI++++ D++ G e++ h--- r++ y+++
<BR>
------END GEEK CODE BLOCK------
<BR>
<P><P>--------------------------- ONElist Sponsor ----------------------------
<BR>
<P>Start a new ONElist list &amp; you can WIN great prizes!
<BR>
<A HREF="http://www.onelist.com">http://www.onelist.com</A>
<BR>
See homepage for details on ONElist’s new &quot;FRIENDS &amp; FAMILY&quot; program.
<BR>
<P>------------------------------------------------------------------------
<BR>
<P><!-- body="end" -->
<HR NOSHADE>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0311.html">Campbell Simpson: "[cricket-users] Differences in graphing between 0.65 and 0.68"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0309.html">Jeff Allen: "Re: [cricket-users] Possible feature?"</A>
<LI><STRONG>Maybe in reply to:</STRONG> <A HREF="0305.html">Berg, Ivan: "[cricket-users] Possible feature?"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0312.html">Berg, Ivan: "RE: [cricket-users] Possible feature?"</A>
<!-- reply="end" -->
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#310">[ date ]</A>
<A HREF="index.html#310">[ thread ]</A>
<A HREF="subject.html#310">[ subject ]</A>
<A HREF="author.html#310">[ author ]</A>
</UL>
<!-- trailer="footer" -->
<HR NOSHADE>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.hypermail.org/">hypermail 2b29</A> 
: <EM>Mon Mar 06 2000 - 19:00:56 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
