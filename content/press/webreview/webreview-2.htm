<html>
<head>
<title>webreview.com - Cricket Part 2 - Step by Step Installation</title><META NAME="Description" CONTENT="Brian Wilson walks you through the steps for setting up Cricket."><META NAME="Keywords" CONTENT="">
<SCRIPT LANGUAGE="JavaScript" SRC="http://web.archive.org/web/20001202174000js_/http://webreview.com/iwr/layouts/common/wrmenu.js"></SCRIPT>
<LINK HREF="http://web.archive.org/web/20001202174000/http://webreview.com/iwr/layouts/webreviewstyle.css" type="text/css" rel="stylesheet">

</head><BODY BGCOLOR="#FFFFFF" LINK="#006699" VLINK="#CCCC66" ALINK="#CCCCCC" TEXT="#000000" LEFTMARGIN=5 TOPMARGIN=5>


<!-- article/pre.html -->
<center><table width="610" border="0" cellspacing="0" cellpadding="0"><tr valign="top"><td width="1"><img src="white.gif" alt="blank.gif" height=70 width=1 border=0></td><td width="139"><iframe width="120" height="60" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" bordercolor="#000000" src="about:blank">  
</iframe>
</td><td align="center"><center><iframe width="468" height="60" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" bordercolor="#000000" src="about:blank">  
</iframe>
</center></td></tr></table><!-- common/wrmasthead.html -->
<TABLE WIDTH="610" BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
<TD ROWSPAN="2" VALIGN="TOP" WIDTH="313"><A HREF="/wr/pub"><IMG SRC="white.gif" WIDTH=313 HEIGHT=47 BORDER=0 ALT="webreview.com - Cross-Training for Web Teams"></A></TD>
<TD VALIGN="BOTTOM" WIDTH="297" ALIGN="right"><FONT FACE="Verdana,Arial,Helvetica" SIZE="-1"><FORM NAME="searchform" ACTION="/wr/pub" METHOD="get"><INPUT TYPE=hidden name=x-tb value=a>Search for: <INPUT TYPE="Text" name="x-searchall" SIZE="13" MAXLENGTH="255">&nbsp;<INPUT TYPE="Image" NAME="" SRC="white.gif" BORDER="0" WIDTH="54" HEIGHT="13" name="x-a" value="Search"></FONT></TD>
	<TD></FORM></TD>
</TR>
<TR>
	<TD VALIGN="top"  ALIGN="right"><FONT FACE="Verdana,Arial,Helvetica" SIZE="-1"><FORM NAME = "jumpform" onSubmit="return isReady(this);" ACTION="/wr/pub" METHOD="post"> Jump to:
<SELECT NAME="wrguide" onChange="return isReady(jumpform);">
<OPTION Value="Topics:">Topics:
<OPTION>
<OPTION>Authoring:
<OPTION VALUE="HTML">--HTML
<OPTION VALUE="Dynamic_HTML">--DHTML
<OPTION VALUE="JavaScript">--JavaScript
<OPTION VALUE="Style_Sheets">--Style Sheets
<OPTION>
<OPTION>Design:
<OPTION VALUE="Fonts">--Fonts
<OPTION VALUE="Graphics">--Graphics
<OPTION VALUE="Navigation">--Navigation
<OPTION VALUE="Usability">--Usability
<OPTION VALUE="Web_Design">--Web Design
<OPTION>
<OPTION>Development:
<OPTION VALUE="Databases">--Databases
<OPTION VALUE="Java">--Java
<OPTION VALUE="Perl">--Perl
<OPTION VALUE="XML">--XML
<OPTION>
<OPTION>eCommerce:
<OPTION VALUE="Advertising">--Advertising
<OPTION VALUE="Legal">--Legal
<OPTION VALUE="Storefronts">--Storefronts
<OPTION>
<OPTION>Multimedia:
<OPTION VALUE="Audio/Video">--Audio/Video
<OPTION VALUE="Animation">--Animation
<OPTION VALUE="Shockwave">--Shockwave
<OPTION>
<OPTION>Backend:
<OPTION VALUE="Networks">--Networks
<OPTION VALUE="Security">--Security
<OPTION VALUE="Servers">--Servers
</SELECT>&nbsp;<INPUT TYPE="Image" NAME="" SRC="white.gif" BORDER="0" WIDTH="54" HEIGHT="13"></FONT></TD>
	<TD></FORM></TD>
</TR>
<TR>
	<TD COLSPAN="3"><IMG SRC="white.gif" ALT="blank.gif" HEIGHT=5 WIDTH=1 BORDER=0></TD>
</TR>
</TABLE>

<table width="610" border="0" cellspacing="0" cellpadding="0">
<tr>
	<td width="1" bgcolor="#006699"><img src="white.gif" ALT="blank.gif" height="1" width="1" border="0"></td>
	<td width="149" valign="top">
<!-- start left nav bar -->

<center>
<center><table border="0" cellspacing="5" cellpadding="0">
<tr>
<td width="100%" valign="top">
<div class="navbar">
<table cellpadding="5" width="100%"><td bgcolor="#99ccff"><b>Servers</b><br><A HREF=/pub/Servers><font size=2>Related Articles</font></a><br></td></table><!--
-->
<p></p>
<!-- layouts/navbars/basicnav.html -->
<!-- Used in all files except new section layouts - starting w/e-commerce; see sectionnav.html for those; duplicate any ad changes made here in also in sectionnav.html -->
<b>Find</b>
<br />

<A HREF="/pub/Search">Search</a><br />

<A HREF="/pub/List_Depts">List Departments</a><br />

<A HREF="/pub/List_Topics">List Topics</a><p></p>
<a href="/wr/pub/webtools">Web Tools Guide</a><p>
Buy Software at the</FONT><br />

<a href="http://store.webreview.com">Web Tools Store</a></strong>
<br />
<br />


<hr size=1 color="#006699" noshade>
<center>

<iframe width="125" height="125" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" bordercolor="#000000" src="about:blank">  
</iframe>
</center>
<hr size=1 color="#006699" noshade>
<div class="navbar">
<a href="/pace/print/2000/02/25/feature/index2a.html"><img src="/universal/images/sm-printer.jpg" width="26" height="28" alt="printer icon" border="0" align="left">Print This Page</a><br clear="all" /><hr size="1" color="#006699" noshade%3dnoshade /><a href="/pub/universal/mediakit/contact.html">Contact Us</a></div>
<hr size=1 color="#006699" noshade>
<DIV CLASS="navbar">
<a href="http://www.webreview.com/pub/v/webauthoring"><b>Authoring</b></a>
<br />

<A HREF="/pub/HTML">HTML</a><br />

<A HREF="/pub/Dynamic_HTML">Dynamic HTML</a><br />

<A HREF="/pub/JavaScript">JavaScript</a><br />

<A HREF="/pub/Style_Sheets">Style Sheets</a><p></p>
<a href="http://www.webreview.com/pub/design"><b>Design</b></a>
<br />

<A HREF="/pub/Fonts">Fonts</a><br />

<A HREF="/pub/Graphics">Graphics</a><br />

<A HREF="/pub/Navigation">Navigation</a><br />

<A HREF="/pub/Usability">Usability</a><br />

<A HREF="/pub/Web_Design">Web Design</a><p></p>
<a href="http://www.webreview.com/pub/v/development"><b>Development</b></a>
<br />

<A HREF="/pub/Databases">Databases</a><br />

<A HREF="/pub/Java">Java</a><br />

<A HREF="/pub/Perl">Perl</a><br />

<A HREF="/pub/XML">XML</a><p></p>
<a href="http://www.webreview.com/pub/v/ecommerce"><b>E-Commerce</b></a>
<br />

<A HREF="/pub/Advertising">Advertising</a><br />

<A HREF="/pub/Legal">Legal</a><br />

<A HREF="/pub/Storefronts">Storefronts</a><p></p>

<a href="http://www.webreview.com/pub/v/multimedia"><b>Multimedia</b></a>
<br />

<A HREF="/pub/Audio/Video">Audio/Video</a><br />

<A HREF="/pub/Animation">Animation</a><br />

<A HREF="/pub/Shockwave">Shockwave</a><p></p>
<a href="http://www.webreview.com/pub/v/backend"><b>Backend</b></a>
<br />

<A HREF="/pub/Networks">Networks</a><br />

<A HREF="/pub/Security">Security</a><br />

<A HREF="/pub/Servers">Servers</a><br />

<A HREF="/pub/Traffic">Traffic</a><p></p>

</DIV>
<hr size=1 color="#006699" noshade>
<center>

<iframe width="125" height="125" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" bordercolor="#000000" src="about:blank">  
</iframe>

</center>
<hr size=1 color="#006699" noshade>

<!-- end of navbar -->
</div>
<p>&nbsp;</p>
</td>
</tr>
</table>
<!-- end left nav bar -->
<img src="white.gif" width="149" height="100" align="top">
Sponsored by:<br>

<iframe width="120" height="60" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" bordercolor="#000000" src="about:blank">  
</iframe>
</center>
	<td width="1" bgcolor="#006699"><img src="white.gif" width="1" height="1" align="bottom"></td>
	<td width="10"><img src="white.gif" width="10" height="1" align="bottom"></td>
	<td bgcolor="#ffffff" valign="top"><div align="right" class="depthead"><font face="arial, helvetica" color="#006699"><b>
<A HREF=/pub/at/Feature>Feature</a></b></font></div>
<hr size="1" width="100%" noshade>
<h2>Installing Cricket, Step by Step</h2>
by <A HREF=/pub/au/Wilson_Brian>Brian Wilson</a><br />
Feb. 25, 2000<p>
For our basic Cricket set-up, let's assume you're going to install it on a Linux server that already has an Apache server running on it. Also you'll need to have installed the basic development tools: make, gcc compiler, and the linux kernel headers.
</p>
 

<p>
I derived these instructions from the beginner.txt file in the cricket/doc directory. My instructions are more explicitly geared for a Linux system; if you are running something else, you'll probably want to refer to the beginner.txt as well. So, let's get started.
</p>


<p>
You have to have a recent version of Perl, version 5.004 or newer. To check the version number, use: "perl -v."
</p>


<p>
You will need these packages from CPAN (Comprehensive Perl Archive Network); you may have some of them already.
</p>
<p>
<table cellspacing="0" cellpadding="6" border="1">
<tr>
<td bgcolor="cccce0" valign="top">
<b>Package name</b></td>
<td bgcolor="cccce0" valign="top">
<b>Where to get it:</b></td>
</tr>
<td valign="top">MD5 CPAN</td>
<td>by-authors/id/GAAS/Digest-MD5-*.tar.gz</td>
</tr>
<tr>
<td valign="top">LWP CPAN</td>
<td valign="top">by-authors/id/GAAS/libwww-perl-*.tar.gz</td>
</tr>
<tr>
<td valign="top">DB_File CPAN</td>
<td valign="top">by-authors/id/PMQS/DB_File-*.tar.gz Date::Parse</td>
<tr>
<td valign="top">CPAN</td>
<td valign="top">by-authors/id/GBARR/Timedate-*.tar.gz Time::HiRes</td>
</tr>
<tr>
<td valign="top">CPAN</td>
<td valign="top">by-authors/id/DEWEG/Time-HiRes-*.tar.gz</td>
</tr>
</table>
</p>


<p>
If you have the CPAN module installed and configured, you can just issue the following commands while running as root. If you have the CPAN module but have not configured it, the first time you run it, it will ask some questions. Go ahead and give it a shot; it's not that hard. Otherwise you can go to http://www.cpan.org/ and find the modules, download them, unpack them, and build and install each one by following the README instructions that come with them. This is known as doing it the hard way.
</p>


<p>
Each of these CPAN module commands will install the latest version of each package. It is safe to run the command; if the latest version is already installed, it will just tell you that and stop.
</p>
<code>
<pre>
 perl -MCPAN -eshell  
 cpan> install MD5  
 cpan> install LWP  
 cpan> install DB_File  
 cpan> install Date::Parse  
 cpan> install Time::HiRes  
 cpan> quit
 </pre>
 </code>
<p>
There are two more packages that are not in the CPAN archives, so you have to fetch and install them separately (i.e., the hard way). Use your web browser to find the latest version of each, download it to a spot on your system where you can unpack and build the package, then use your rootly powers to install it.
</p>


<p>
First the SNMP_Session package: For this http tracking project we actually don't need to use any SNMP services, but Cricket requires the package so you have to install it anyway.
</p>


<dl>
<dt>The SNMP_Session website is: 
<dd><a href="http://www.switch.ch/misc/leinen/snmp/perl">http://www.switch.ch/misc/leinen/snmp/perl</a> 
</dl>
<dl>
<dt>You can download the latest version from: 
<dd>
<a href="ftp://ftp.switch.ch/software/sources/network/snmp/perl">ftp://ftp.switch.ch/software/sources/network/snmp/perl</a>
</dl>
<p>
Here are the abbreviated instructions on building version 0.76:
<code>
<pre>
    % tar xzf SNMP_Session-0.76.tar.gz
    % cd SNMP_Session-0.76
    % perl Makefile.PL
    % make
    % su root
    Password:
    # make install
    # exit
    % cd ..
</pre>
</code>
<p>
<dl>
<dt>
The RRD package is the heart of Cricket.
The main RRD site is: 
<dd><a href="http://ee-staff.ethz.ch/~oetiker/webtools/rrdtool/">http://ee-staff.ethz.ch/~oetiker/webtools/rrdtool/</a>.</dd></p>

<dt>You can download the package from:
<dd>
<a href="http://ee-staff.ethz.ch/~oetiker/webtools/rrdtool/pub/">http://ee-staff.ethz.ch/~oetiker/webtools/rrdtool/pub/</a>.</dd>
</dl></p>
<p>
Here are the abbreviated instructions on building version 1.0.11:
<code>
<pre>
    % tar xzf rrdtool-1.0.11.tar.gz
    % cd rrdtool-1.0.11
</pre>
</code>
</p>
<p>I had to do this to get configure to work on one of my systems:
<code>
<pre>
    % unset noclobber

    % ./configure
    % make
    % su root
    Password:
</pre>
</code>
<p>
This next line will install the rrd perl modules in your system's
standard site-perl directory tree instead of putting them in a separate
location (which is what 'make install' does). This is necessary for
the cricket scripts to find the rrd modules.
</p>
<code>
<pre>
    # make site-perl-install
</pre>
</code>
<p>
Now, as root, create a user account that will run cricket.
</p>
<p>
These commands work on a Linux system; use your own preference on your
system to create a cricket user. You don't strictly need a separate
cricket account, but I find it is a lot easier this way.
</p>
[Still su'ed to root from previous step]<pre><code>
    # groupadd cricket
    # useradd -g cricket -c 'Cricket Traffic Grapher' cricket
    # passwd cricket
    # chmod 755 ~cricket
</code>
    Set an alias to receive cricket's mail.
<code>
    # echo "cricket: root" >> /etc/aliases
    # newaliases
    # exit
</code>
</pre>
<p>
Download and install cricket.
</p>
<pre>
<code>
    % su - cricket
    Password:
</code>
</pre>
</p>
<p>Now that you're running as cricket, use a browser to download the 
Cricket source archive from <a href="http://www.munitions.com/~jra/cricket/download.html">here</a>.
</p>
<p>
Here are the abbreviated instructions on installing version 0.72:
<pre>
<code>
    % tar xzf cricket-0.72.tar.gz
</code>
</pre>
Using this symbolic link will allow you to upgrade easily later:
<pre>
<code>
    % ln -s cricket-0.72 cricket
    % cd cricket
</code>
</pre>
<p>Running 'configure' will fix up the first line of each Cricket script
so they can find perl on your system.</p>
<pre>
<code>
    % ./configure
</code>
</pre>
<p>Now we get into the configuration; this is the most
complicated step. Copy the sample configuration tree to
the ~cricket/cricket-config directory, which is where
the installed cricket will look for it.</p>
<pre>
</code>
    % cd ..
    % cp -r cricket/sample-config cricket-config
</code>
</pre>
<p>
There are lots of set-up files in there that won't be used but maybe
you'll want them later; they won't hurt anything for now. For now
we are only interested in cricket-config/http-performance. Edit
the urls file.</p> 
<pre>
<code>
    % cd cricket-config/http-performance
    % ls
    Defaults  urls
    % emacs urls
</code>
</pre>
<p>The sample file looks like this. Remove those entries and put in
entries for whatever you would like to monitor.
</p>
<pre>
<code>
    target  cricket-home
        short-desc = "The Cricket Homepage"
        url = "http://www.munitions.com/~jra/test-file.txt"

    target  www.cnn.com
        url = "http://www.cnn.com"
</code>
</pre>
<p>
<ul>
<li>The 'target' name (e.g., cricket-home) will be used to name the
database table, and as the default name in the web interface.</li>

<li>The 'short-desc' text will override the target name in the web
interface.</li>

<li>The 'url' can be any standard http statement.</li>
</ul> 

<p>You can have as many targets as you like; each one will cause a
database table of approximately 60KB to be created. Note though that
if it takes more than five minutes to collect a set of data, you will
get warning messages in the mail telling you "the collection subtree
is locked." You can ignore these messages or change the collection
interval.</p>

<p>The 'Defaults' file in this directory contains settings to control how
the data is displayed&#151;what text appears, and so on. For a while, one
of my servers was consistently delivering pages in times greater than
5 seconds. I had to change the setting for 'y-max' so that I could see
more data on the graphs. I won't tell you how slow the server was...
too embarrassing. Every page on that site was generated by perl
scripts.</p>

<p>Each time you make changes to the cricket-config files, you have to
recompile them. There will be error messages if you entered anything
incorrectly.</p>
<pre>
<code>
   % cd ~
   % cricket/compile
</code>
</pre>
<p>
To test the data collector, run it now manually.</p>
<pre>
<code>
   % cricket/collector /http-performance
</code>
</pre>
<p>If it works, you'll see a lot of messages like this indicating Cricket is
testing each target in your config file:</p>
<pre>
<code>
   [09-Feb-2000 22:26:55 ] Retrieving data 
   (EXEC: /home/cricket/cricket-config/../cricket/util/test-url 
   http://www.xml.com) for xml
</code>
</pre>
</p>
<p>The collector will also create the data tables in
~cricket/cricket-data/http-performance the first time you run it.</p>

<p>The collector is run from a script called collect-subtrees.
You can set up 'cron' to run different collection sets at different
intervals. The file cricket/subtrees-sets defines what is in
each set. For our example, you will have to edit that file to change
the lines.</p>
<code>
<pre>
    set normal:
  /routers
  /router-interfaces
</pre>
</code>
to
<pre>
<code>
    set normal:
  /http-performance
</code>
</pre>

<p>Now, to test collection of the set, run the wrapper script:</p>
<pre>
<code>
   % cricket/collect-subtrees normal
   % exit
</code>
</pre>
<p>You won't see any output from this script, but the wrapper will create
another directory, cricket-logs and log its output to file in it,
normal.0.</p>


<h3>Make cron entry</h3>

<p>Now you are ready to set up a cron job to run the collection script.
Make a cron entry to run cricket once every 5 minutes.  I run Cricket
from the /etc/cron.d directory. You could run it directly under the
cricket account (using 'crontab -e' command to edit the file), but I
find it easier to keep track of what administrative cron jobs are
installed by putting them all in /etc/cron.d.</p>
<pre>
<code>
   % su root
</code>
</pre>
[Next command all on one line]
<pre><code>
   # echo "*/5 * * * * cricket 
   /home/cricket/cricket/collect-subtrees normal" > 
   /etc/cron.d/cricket
   
   # exit
</code>
</pre>
<p>
Now wait until the next 5 minute increment rolls around and watch to
see if the data collection happens. Once cricket has been running for
a while you will see a series of files from "normal.0" to "normal.20";
each time collect-subtrees runs, it renumbers the files so the newest
one is always "normal.0".</p>
<p>
Cricket is now logging data. If you modify the files in cricket-config,
remember to re-run 'compile' to update the configuration.</p>
<p>
In part three, we'll cover how to set things up for web browsing.
</p>
<p><b>Next:</b> <A HREF=webreview-3.htm><b>Cricket Part 3 - Set Things Up for Web Browsing</b></a><br><b>Prev:</b> <A HREF=webreview-1.htm><b>Apache Server Page Load Monitoring With Cricket</b></a><br><!-- article/post.html -->
<IMG SRC="white.gif" WIDTH="449" HEIGHT="1" BORDER="0" ALT=""></TD></TABLE>
<BR>
<TABLE WIDTH="610" BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR VALIGN="top">
<TD WIDTH="139">

<iframe width="120" height="60" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" bordercolor="#000000" src="about:blank">  
</iframe>
</TD>
<TD ALIGN="CENTER"><CENTER>

<iframe width="468" height="60" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no" bordercolor="#000000" src="about:blank">  
</iframe>
</CENTER></TD>

</TR>
<TR>
<TD COLSPAN=2>
<!-- common/copyright.html -->
<center><font size="-2"><a href="/wr/pub/universal/mediakit/contact.html">Web Review</a> copyright &#169; 1995-2000 Miller Freeman, Inc.<br />

</font></center>
</TD>
</TR></TABLE>
</CENTER>
<!--dc base tag-->
</BODY>
</SCRIPT>
</HTML>
